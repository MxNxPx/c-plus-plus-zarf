# Copyright 2024 Defense Unicorns
# SPDX-License-Identifier: AGPL-3.0-or-later OR LicenseRef-Defense-Unicorns-Commercial

# yaml-language-server: $schema=https://raw.githubusercontent.com/defenseunicorns/zarf/main/zarf.schema.json
kind: ZarfPackageConfig
metadata:
  name: c-plus-plus
  description: "UDS C++ Example"
  version: "###ZARF_PKG_TMPL_VERSION###"

constants:
  - name: VERSION
    value: "###ZARF_PKG_TMPL_VERSION###"
  - name: PLATFORM
    value: "###ZARF_PKG_TMPL_PLATFORM###"

components:
  - name: c-plus-plus
    required: true
    charts:
      - name: uds-c-plus-plus
        namespace: c-plus-plus
        version: 0.1.0
        localPath: ./chart
    actions:
      onCreate:
        before:
          - description: Build the container image
            cmd: docker build -t c-plus-plus-api:0.1.0 --platform "###ZARF_PKG_TMPL_PLATFORM###" .
            dir: src/c-plus-plus-api/
    images:
      - c-plus-plus-api:0.1.0
